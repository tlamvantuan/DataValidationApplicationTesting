<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Days Calculator - Date Validation System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand" href="/">
            <i class="fas fa-calendar-alt me-2"></i>Date Validation System
        </a>
        <div class="navbar-nav ms-auto">
            <a class="nav-link" href="/">Home</a>
            <a class="nav-link" href="/date-validator">Validate Date</a>
            <a class="nav-link active" href="/days-calculator">Days Calculator</a>
            <a class="nav-link" href="/swagger-ui.html" target="_blank">API Docs</a>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-info text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-calculator me-2"></i>Days in Month Calculator
                    </h3>
                </div>
                <div class="card-body">
                    <p class="mb-4">
                        Tính số ngày trong tháng của một năm cụ thể. Hệ thống sẽ xử lý năm nhuận và trả về kết quả chính xác.
                    </p>

                    <form id="daysForm">
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="calcMonth" class="form-label">Tháng</label>
                                <select class="form-select" id="calcMonth" name="month" required>
                                    <option value="">Chọn tháng</option>
                                    <option value="1">Tháng 1 - January</option>
                                    <option value="2">Tháng 2 - February</option>
                                    <option value="3">Tháng 3 - March</option>
                                    <option value="4">Tháng 4 - April</option>
                                    <option value="5">Tháng 5 - May</option>
                                    <option value="6">Tháng 6 - June</option>
                                    <option value="7">Tháng 7 - July</option>
                                    <option value="8">Tháng 8 - August< /option>
                                    <option value="9">Tháng 9 - September</option>
                                    <option value="10">Tháng 10 - October</option>
                                    <option value="11">Tháng 11 - November</option>
                                    <option value="12">Tháng 12 - December</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="calcYear" class="form-label">Năm</label>
                                <input type="number" class="form-control" id="calcYear" name="year"
                                       min="1" max="9999" placeholder="VD: 2024" required>
                            </div>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                            <button type="submit" class="btn btn-info btn-lg">
                                <i class="fas fa-calculator me-2"></i>Calculate Days
                            </button>
                            <button type="button" class="btn btn-outline-secondary btn-lg" onclick="clearCalcForm()">
                                <i class="fas fa-times me-2"></i>Clear
                            </button>
                        </div>
                    </form>

                    <!-- Result Display -->
                    <div id="calcResult" class="mt-4" style="display: none;">
                        <div class="alert" id="calcResultAlert">
                            <h5 id="calcResultMessage"></h5>
                            <div id="calcResultDetails" class="mt-2"></div>
                        </div>
                    </div>

                    <!-- Quick Year Overview -->
                    <div class="mt-5">
                        <h5>Quick Test - Năm 2024 (Năm nhuận):</h5>
                        <div class="row g-2">
                            <div class="col-md-2">
                                <button class="btn btn-outline-secondary btn-sm w-100" onclick="quickCalc(1, 2024)">Jan</button>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-danger btn-sm w-100" onclick="quickCalc(2, 2024)">Feb</button>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-secondary btn-sm w-100" onclick="quickCalc(3, 2024)">Mar</button>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-secondary btn-sm w-100" onclick="quickCalc(4, 2024)">Apr</button>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-secondary btn-sm w-100" onclick="quickCalc(5, 2024)">May</button>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-secondary btn-sm w-100" onclick="quickCalc(6, 2024)">Jun</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.getElementById('daysForm').addEventListener('submit', async function(e) {
        e.preventDefault();

        const formData = new FormData(e.target);
        const month = parseInt(formData.get('month'));
        const year = parseInt(formData.get('year'));

        try {
            const response = await fetch('/calculate-days', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: `month=${month}&year=${year}`
            });

            const result = await response.json();
            displayCalcResult(result);
        } catch (error) {
            showCalcError('Có lỗi xảy ra khi tính số ngày!');
        }
    });

    function displayCalcResult(result) {
        const resultDiv = document.getElementById('calcResult');
        const alertDiv = document.getElementById('calcResultAlert');
                const messageDiv = document.getElementById('calcResultMessage');

        alertDiv.className = result.days > 0 ? 'alert alert-success' : 'alert alert-danger';
        messageDiv.textContent = result.message;

        resultDiv.style.display = 'block';
    }

    function quickCalc(month, year) {
        document.getElementById('calcMonth').value = month;
        document.getElementById('calcYear').value = year;
        document.getElementById('daysForm').dispatchEvent(new Event('submit'));
    }

    function clearCalcForm() {
        document.getElementById('daysForm').reset();
        document.getElementById('calcResult').style.display = 'none';
    }

    function showCalcError(message) {
        const resultDiv = document.getElementById('calcResult');
        resultDiv.innerHTML = `<div class="alert alert-danger">${message}</div>`;
        resultDiv.style.display = 'block';
    }
</script>
</body>
</html>