<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Date Validator - Date Validation System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand" href="/">
            <i class="fas fa-calendar-alt me-2"></i>Date Validation System
        </a>
        <div class="navbar-nav ms-auto">
            <a class="nav-link" href="/">Home</a>
            <a class="nav-link active" href="/date-validator">Validate Date</a>
            <a class="nav-link" href="/days-calculator">Days Calculator</a>
            <a class="nav-link" href="/swagger-ui.html" target="_blank">API Docs</a>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-check-circle me-2"></i>Date Validator
                    </h3>
                </div>
                <div class="card-body">
                    <p class="mb-4">
                        Nhập ngày, tháng, năm để kiểm tra tính hợp lệ. Hệ thống sẽ xử lý năm nhuận và các trường hợp đặc
                        biệt.
                    </p>

                    <form id="dateForm">
                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <label for="day" class="form-label">Ngày</label>
                                <input type="number" class="form-control" id="day" name="day"
                                       min="1" max="31" placeholder="1-31" required>
                            </div>
                            <div class="col-md-4">
                                <label for="month" class="form-label">Tháng</label>
                                <select class="form-select" id="month" name="month" required>
                                    <option value="">Chọn tháng</option>
                                    <option value="1">Tháng 1</option>
                                    <option value="2">Tháng 2</option>
                                    <option value="3">Tháng 3</option>
                                    <option value="4">Tháng 4</option>
                                    <option value="5">Tháng 5</option>
                                    <option value="6">Tháng 6</option>
                                    <option value="7">Tháng 7</option>
                                    <option value="8">Tháng 8</option>
                                    <option value="9">Tháng 9</option>
                                    <option value="10">Tháng 10</option>
                                    <option value="11">Tháng 11</option>
                                    <option value="12">Tháng 12</option>
                                    <option value="13">Tháng 13</option>
                                    <option value="14">Tháng 14</option>

                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="year" class="form-label">Năm</label>
                                <input type="number" class="form-control" id="year" name="year"
                                       min="1" max="9999" placeholder="VD: 2024" required>
                            </div>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                            <button id="check-btn" type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-check me-2"></i>Validate Date
                            </button>

                            <button type="button" class="btn btn-outline-secondary btn-lg" onclick="clearForm()">
                                <i class="fas fa-times me-2"></i>Clear
                            </button>
                        </div>
                    </form>

                    <!-- Result Display -->
                    <div id="result" class="mt-4" style="display: none;">
                        <div class="alert" id="resultAlert">
                            <h5 id="resultMessage"></h5>
                            <div id="resultDetails" class="mt-2"></div>
                        </div>
                    </div>

                    <!-- Example Tests -->
                    <div class="mt-5">
                        <h5>Test Cases Mẫu:</h5>
                        <div class="row g-2">
                            <div class="col-md-3">
                                <button class="btn btn-outline-info btn-sm w-100" onclick="testCase(29, 2, 2024)">
                                    29/2/2024
                                </button>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-outline-info btn-sm w-100" onclick="testCase(29, 2, 2023)">
                                    29/2/2023
                                </button>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-outline-info btn-sm w-100" onclick="testCase(31, 4, 2024)">
                                    31/4/2024
                                </button>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-outline-info btn-sm w-100" onclick="testCase(15, 1, 2024)">
                                    15/1/2024
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Handle form submission
    document.getElementById('dateForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const formData = new FormData(e.target);
        const day = parseInt(formData.get('day'));
        const month = parseInt(formData.get('month'));
        const year = parseInt(formData.get('year'));

        try {
            const response = await fetch('/validate-date', {
                method: 'POST',
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                body: `day=${day}&month=${month}&year=${year}`
            });

            const result = await response.json();
            displayResult(result);
        } catch (error) {
            showError('Có lỗi xảy ra khi validate ngày!');
        }
    });

    function displayResult(result) {
        const resultDiv = document.getElementById('result');
        const alertDiv = document.getElementById('resultAlert');
        const messageDiv = document.getElementById('resultMessage');

        alertDiv.className = result.valid ? 'alert alert-success' : 'alert alert-danger';
        messageDiv.textContent = result.message;

        resultDiv.style.display = 'block';
    }

    function testCase(day, month, year) {
        document.getElementById('day').value = day;
        document.getElementById('month').value = month;
        document.getElementById('year').value = year;
        document.getElementById('dateForm').dispatchEvent(new Event('submit'));
    }

    function clearForm() {
        document.getElementById('dateForm').reset();
        document.getElementById('result').style.display = 'none';
    }

    function showError(message) {
        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = `<div class="alert alert-danger">${message}</div>`;
        resultDiv.style.display = 'block';
    }
</script>
</body>
</html>